<!DOCTYPE html>

<div>
	<button type="action" name="act_character" >Character</button>
	<button type="action" name="act_journal" >Journal</button>
</div>
<input type='hidden' class='sheet-tabstoggle' name='attr_sheetTab'  value='character'  />

<div class='sheet-character'>
	<h2>Character</h2>
	<span><div class="block">
		<label>Name:</label>
		<input type=text  style='width: 30em;' name="attr_cname"/>
	</div>

	<br>

	<div class="block">
		<label>Attributes</label>
		<b>ST</b>
		<input type=number width=5 style='width: 5em;' name="attr_ST_max" value="8"/>
		<b>Adj</b>
		<input type=number width=5 style='width: 5em;' name="attr_ST" value="8"/>
		<button type=roll value="/roll 3d6"></button>
		<b>Fatigue</b>
		<input type=number width=5 style='width: 5em;' name="attr_Fatigue" value="0"/>
		<b>Hits</b>
		<input type=number width=5 style='width: 5em;' name="attr_Hits" value="0"/>
		<b>DMG Max</b>
		<input type=number name="attr_dmg_max" value="0" />
		<b>DMG</b>
		<input type=number name="attr_dmg" value="0" />
		<b>Hurt</b> 
		<input type=number name="attr_hurtmod" value="0" />
		<b>KD</b> 
		<input type=number name="attr_knockdown" value="0" />
	</div>

	<br>

	<div class="block">
		<b>DX</b>
		<input type=number width=5 style='width: 5em;' name="attr_DX_max" value="8"/>
		<b>Adj</b>
		<input type=number width=5 style='width: 5em;' name="attr_DX" value="8"/>
		<button type=roll value="/roll 3d6"></button>
	</div>

	<br>

	<div class="block">
		<b>IQ</b>
		<input type=number width=5 style='width: 5em;' name="attr_IQ_max" value="8"/>
		<b>Adj</b>
		<input type=number width=5 style='width: 5em;' name="attr_IQ" value="8"/>
		<button type=roll value="/roll 3d6"></button>
	</div>

	<br>

	<div class="block">
		<b>MA</b>
		<input type=number width=5 style='width: 5em;' name="attr_MA_max" value="10"/>
		<b>Adj</b>
		<input type=number width=5 style='width: 5em;' name="attr_MA" value="10"/>
	</div>

	<br>

	<div class="block">
		<label>Weapons</label>
		<b style='display: inline-block; width: 10em;'>Name</b>
		<b style='display: inline-block; width: 5em;'>Damage</b>
		<b style='display: inline-block; width: 10em;'>Notes</b>
		<br>
		<fieldset class=repeating_weapons>
			<input type=text name=attr_weaponname style='width: 10em;'>
			<input type=text name=attr_weapondamage value="1d6" style='width: 5em;'>
			<input type=text name=attr_weaponnotes style='width: 25em;'>
			<button type=roll value="@{character_name} Attacks with their @{weaponname}! Roll [[3d6]] vs [[@{DX}]]; Damage [[@{weapondamage}]]"></button>
			<b style='display: inline-block; width: 5em;'>Throwable</b>
			<input type="checkbox" name="Thrown" value="1" checked >
			<b style='display: inline-block; width: 4em;'>Missile</b>
			<input type="checkbox" name="Missile" value="1" checked >
			<b style='display: inline-block; width: 4em;'>2-Hand</b>
			<input type="checkbox" name="TwoHand" value="1" checked >
		</fieldset>
	</div>

	<br>

	<div class="block">
		<label>Armor and Shields</label>
		<b style='display: inline-block; width: 16em;'>Name</b>
		<b style='display: inline-block; width: 8em;'>Hits Blocked</b>
		<b style='display: inline-block; width: 8em;'>DX Modifier</b>
		<b style='display: inline-block; width: 10em;'>Notes</b>
		<br>
		<fieldset class=repeating_armor>
			<input type=text name=attr_defensename value="" style='width: 8em;'>
			<b style='display: inline-block; width: 3em;'>Shield</b>
			<input type="checkbox" name="attr_HasShield" value="1" checked >
			<b style='display: inline-block; width: 2em;'>MG</b>
			<input type="checkbox" name="attr_HasMG" value="1" checked >
			<input type=text name=attr_hitsblocked value="0" style='width: 8em;'>
			<input type=text name=attr_dxmod value="0" style='width: 8em;'>
			<input type=text name=attr_defensenotes style='width: 20em;'>
			<b style='display: inline-block; width: 5em;'>Equipped</b>
			<input type="checkbox" name="Ready" value="1" checked >
			</fieldset>
	</div>
	<div class="block">
		<b style='display: inline-block; width: 5em;'>Total Hits Blocked </b>
		<input type=text name=attr_totalblock_max value="0" style='width: 5em;' />
		<b style='display: inline-block; width: 9em;'>Total Blocked without Shield/MG </b>
		<input type=text name=attr_totalblock value="0" style='width: 5em;' />
		<b style='display: inline-block; width: 7em;'>Total Blocked without MG </b>
		<input type=text name=attr_totalblock value="0" style='width: 5em;' />

	<br><br>

	<div class="block">
		<label>Spells</label>
		<b style='display: inline-block; width: 10em;'>Name</b>
		<b style='display: inline-block; width: 5em;'>Damage</b>
		<b style='display: inline-block; width: 5em;'>Spell Cost</b>
		<b style='display: inline-block; width: 10em;'>Sustain Cost</b>
		<b style='display: inline-block; width: 10em;'>Notes</b>
		<br>
		<fieldset class=repeating_spells>
			<input type=text name=attr_spellname style='width: 10em;'>
			<input type=text name=attr_spelldamage style='width: 5em;'>
			<input type=text name=attr_spellcost style='width: 5em;'>
			<input type=text name=attr_spellsustain style='width: 10em;'>
			<input type=text name=attr_spellnotes style='width: 30em;'>
			<button type=roll value="@{character_name} casts @{spellname}! Roll [[3d6]] vs [[@{DX}]]; Damage [[@{spelldamage}]]"></button>
		</fieldset>
	</div>
		<br><br>
			
	<div class="block">
			<label>Talents</label>
			<b style='display: inline-block; width: 10em;'>Name</b>
			<b style='display: inline-block; width: 5em;'>Cost</b>
			<b style='display: inline-block; width: 5em;'>IQ Req</b>
			<br>
			<fieldset class=repeating_talents>
				<input type=text name=attr_talentname style='width: 10em;'>
				<input type=text name=attr_talentcost value="0" style='width: 5em;'>
				<input type=text name=attr_talentiq value="8" style='width: 5em;'>
				<button type=roll value="@{character_name} uses @{talentname}! Roll [[3d6]]"></button>
			</fieldset>
		</div>

	<br>
	
	<span class="sheet-spacer"></span>
		
		</span>
</div>
<div class='sheet-journal'>
	<h2>Journal</h2>
	<span><span class="sheet-spacer"></span>
			<h4 class="sheet-center">Other Spells and Talents</h4>
			<textarea name="attr_spells" title="Spells"></textarea>

		<br>

		<span class="sheet-spacer"></span>
			<h4 class="sheet-center">Inventory</h4>
			<textarea name="attr_inventory" title="Inventory"></textarea>
			</span>
			<span class="sheet-spacer"></span>
				<h4 class="sheet-center">Notes</h4>
				<textarea name="attr_notes" title="Notes"></textarea>
				</span>
			</span> 
</div>


<script type="text/worker">
	const buttonlist = ["character","journal"];
	buttonlist.forEach(button => {
		on(`clicked:${button}`, function() {
			setAttrs({
				sheetTab: button
			});
		});
	});
on("change:ST change:Hits change:Fatigue sheet:opened", function() {  
  getAttrs(["ST","Hits","Fatigue"], function(values) {
    let st = parseInt(values.ST);
    let hits = parseInt(values.Hits);
    let fatigue = parseInt(values.Fatigue);
    let hp = st - hits - fatigue;
    setAttrs({                            
      "dmg": hp
    });
  });
});
on("change:ST sheet:opened", function() {  
  getAttrs(["ST"], function(values) {
    let st = parseInt(values.ST)||0;
    let hpm = st;
    setAttrs({                            
      "dmg_max": hpm
    });
  });
});
on("change:hurtmod", function() {  
  getAttrs(["ST","DX"], function(values) {
    let hm = parseInt(values.hurtmod);
    if(hm>0){
    let dx = dx-2;
    }
    if(hm==0){
    let dx = dx+2;
    }
    setAttrs({                            
      "DX": dx
    });
  });
});
</script>


